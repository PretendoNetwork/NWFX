"use strict";window.onerror=function(e,t,n){return alert("Error occured on line "+n+": "+e),!1};var defaultTriggers={INPUT:"change",TEXTAREA:"change",SELECT:"change",FORM:"submit"},validSwapAreas=["innerHTML","outerHTML","afterbegin","beforebegin","beforeend","afterend","delete","none"],validEvents=["click","change","submit","load"];function URLEncodeObject(t){return Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")}function hydrateHTMLEvents(e){var t=[];e.querySelectorAll('[nwfx-boost="true"]:not([nwfx-hydrated])').forEach(function(e){e.querySelectorAll("a:not([nwfx-hydrated])").forEach(function(e){e.setAttribute("nwfx-get",e.href),e.setAttribute("nwfx-target","body")}),e.setAttribute("nwfx-hydrated","true")}),e.querySelectorAll("[nwfx-get]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-post]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-put]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-patch]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-delete]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)});for(var n=0,r=t;n<r.length;n++){var a=r[n],i="click";if(a.hasAttribute("nwfx-trigger")){var o=a.getAttribute("nwfx-trigger").split(" ");if(!validEvents.includes(o[0]))return;i=o[0]}else defaultTriggers[a.nodeName]&&(i=defaultTriggers[a.nodeName]);a.addEventListener(i,handleNWFXEvent),"load"===i&&a.dispatchEvent(new Event("load")),a.setAttribute("nwfx-hydrated","true")}}function handleNWFXEvent(e){var t,n,r,a=e.target,i=a,o="innerHTML",s=[],u="click",d="",f="",c="";if(a&&a instanceof HTMLElement&&!a.hasAttribute("nwfx-triggered")&&!a.classList.contains("nwfx-request")){if(a.hasAttribute("nwfx-get"))d="GET",f=a.getAttribute("nwfx-get");else if(a.hasAttribute("nwfx-post"))d="POST",f=a.getAttribute("nwfx-post");else if(a.hasAttribute("nwfx-put"))d="PUT",f=a.getAttribute("nwfx-put");else if(a.hasAttribute("nwfx-patch"))d="PATCH",f=a.getAttribute("nwfx-patch");else{if(!a.hasAttribute("nwfx-delete"))return;d="DELETE",f=a.getAttribute("nwfx-delete")}if(f){if(e.preventDefault(),a.hasAttribute("nwfx-target")&&(i=document.querySelector(a.getAttribute("nwfx-target"))),a.hasAttribute("nwfx-swap")&&(n=a.getAttribute("nwfx-swap"))&&n in validSwapAreas&&(o=n),a.hasAttribute("nwfx-trigger")){if(s=a.getAttribute("nwfx-trigger").split(" "),!validEvents.includes(s[0]))return;u=s[0]}else defaultTriggers[a.nodeName]&&(u=defaultTriggers[a.nodeName]);e.type!==u||a.hasAttribute("nwfx-confirm")&&!confirm(a.getAttribute("nwfx-confirm"))||a.hasAttribute("nwfx-prompt")&&null===(c=prompt(a.getAttribute("nwfx-prompt")))||(s.includes("once")&&a.setAttribute("nwfx-triggered","true"),a.classList.add("nwfx-request"),t={},"FORM"!==a.nodeName&&a.hasAttribute("name")&&a.hasAttribute("value")&&(t[a.getAttribute("name")]=a.getAttribute("value")),"FORM"===a.nodeName&&a.querySelectorAll("[name]").forEach(function(e){e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement?t[e.name]=e.value:e.hasAttribute("value")&&(t[e.getAttribute("name")]=e.getAttribute("value"))}),n=URLEncodeObject(t),"GET"===d&&0<n.length&&(f="".concat(f,"?").concat(n)),document.dispatchEvent(new CustomEvent("nwfx:beforeRequest")),(r=new XMLHttpRequest).addEventListener("loadstart",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:loadstart"))}),r.addEventListener("loadend",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:loadend"))}),r.addEventListener("progress",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:progress"))}),r.addEventListener("load",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:load"))}),r.addEventListener("abort",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:abort"))}),r.open(d,f,!0),r.onreadystatechange=function(){var e,t;r.readyState===XMLHttpRequest.DONE&&("delete"===o?a.remove():(200<=(e=r.status)&&e<400?("none"!==o&&i&&i instanceof HTMLElement&&(t=(new DOMParser).parseFromString(r.responseText,"text/html"),"innerHTML"===o?(i.innerHTML=r.responseText,hydrateHTMLEvents(i)):"outerHTML"===o?(i.outerHTML=r.responseText,hydrateHTMLEvents(i.parentElement)):"afterbegin"===o?(i.insertAdjacentElement("afterbegin",t.documentElement),hydrateHTMLEvents(t)):"beforebegin"===o?(i.insertAdjacentElement("beforebegin",t.documentElement),hydrateHTMLEvents(t)):"beforeend"===o?(i.insertAdjacentElement("beforeend",t.documentElement),hydrateHTMLEvents(t)):"afterend"===o&&(i.insertAdjacentElement("afterend",t.documentElement),hydrateHTMLEvents(t))),document.dispatchEvent(new CustomEvent("nwfx:afterOnLoad"))):document.dispatchEvent(new CustomEvent("nwfx:responseError",{detail:{status:e,responseText:r.responseText}})),a.classList.remove("nwfx-request")),document.dispatchEvent(new CustomEvent("nwfx:afterRequest")))},r.setRequestHeader("NWFX-Request","true"),r.setRequestHeader("NWFX-Current-URL",window.location.href),a.hasAttribute("id")&&r.setRequestHeader("NWFX-Trigger",a.id),a.hasAttribute("name")&&r.setRequestHeader("NWFX-Trigger-Name",a.getAttribute("name")),i&&i instanceof HTMLElement&&i.hasAttribute("id")&&r.setRequestHeader("NWFX-Target",i.id),a.hasAttribute("nwfx-prompt")&&r.setRequestHeader("NWFX-Prompt",c),"GET"!==d&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),document.dispatchEvent(new CustomEvent("nwfx:beforeSend")),r.send(n))}}}document.addEventListener("DOMContentLoaded",function(){document.head.insertAdjacentHTML("beforeend","<style>.nwfx-indicator{opacity:0;transition: opacity 200ms ease-in;}.nwfx-request .nwfx-indicator{opacity:1}.nwfx-request.indicator{opacity:1}</style>"),hydrateHTMLEvents(document)}),Array.prototype.includes=function(e){return!!~this.indexOf(e)},NodeList.prototype.forEach=function(e,t){[].forEach.call(this,e,t)};