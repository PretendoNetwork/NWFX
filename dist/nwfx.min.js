"use strict";window.onerror=function(e,t,n){return alert("Error occured on line "+n+": "+e),!1};var defaultTriggers={INPUT:"change",TEXTAREA:"change",SELECT:"change",FORM:"submit"},validSwapAreas=["innerHTML","outerHTML","afterbegin","beforebegin","beforeend","afterend","delete","none"],validEvents=["click","change","submit","load"];function URLEncodeObject(t){return Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")}function hydrateHTMLEvents(e){var t=[];e.querySelectorAll('[nwfx-boost="true"]:not([nwfx-hydrated])').forEach(function(e){e.querySelectorAll("a:not([nwfx-hydrated])").forEach(function(e){e.setAttribute("nwfx-get",e.href),e.setAttribute("nwfx-target","body")}),e.querySelectorAll("form:not([nwfx-hydrated])").forEach(function(e){var t=e.method||"post",n=e.action||window.location.href;e.setAttribute("nwfx-".concat(t.toLocaleLowerCase()),n),e.setAttribute("nwfx-target","body")}),e.setAttribute("nwfx-hydrated","true")}),e.querySelectorAll("[nwfx-get]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-post]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-put]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-patch]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)}),e.querySelectorAll("[nwfx-delete]:not([nwfx-hydrated])").forEach(function(e){return t.push(e)});for(var n=0,r=t;n<r.length;n++){var a=r[n],o="click";if(a.hasAttribute("nwfx-trigger")){var i=a.getAttribute("nwfx-trigger").split(" ");if(!validEvents.includes(i[0]))return;o=i[0]}else defaultTriggers[a.nodeName]&&(o=defaultTriggers[a.nodeName]);a.addEventListener(o,handleNWFXEvent),"load"===o&&a.dispatchEvent(new Event("load")),a.setAttribute("nwfx-hydrated","true")}}function handleNWFXEvent(e){var n=e.target,r=n,a="innerHTML",t=[],o="click",i="",s="",u="";if(n&&n instanceof HTMLElement&&!n.hasAttribute("nwfx-triggered")&&!n.classList.contains("nwfx-request")){if(n.hasAttribute("nwfx-get"))i="GET",s=n.getAttribute("nwfx-get");else if(n.hasAttribute("nwfx-post"))i="POST",s=n.getAttribute("nwfx-post");else if(n.hasAttribute("nwfx-put"))i="PUT",s=n.getAttribute("nwfx-put");else if(n.hasAttribute("nwfx-patch"))i="PATCH",s=n.getAttribute("nwfx-patch");else{if(!n.hasAttribute("nwfx-delete"))return;i="DELETE",s=n.getAttribute("nwfx-delete")}if(s){if(e.preventDefault(),n.hasAttribute("nwfx-target")&&(r=document.querySelector(n.getAttribute("nwfx-target"))),n.hasAttribute("nwfx-swap")&&(f=n.getAttribute("nwfx-swap"))&&f in validSwapAreas&&(a=f),n.hasAttribute("nwfx-trigger")){if(t=n.getAttribute("nwfx-trigger").split(" "),!validEvents.includes(t[0]))return;o=t[0]}else defaultTriggers[n.nodeName]&&(o=defaultTriggers[n.nodeName]);if(e.type===o&&(!n.hasAttribute("nwfx-confirm")||confirm(n.getAttribute("nwfx-confirm")))&&(!n.hasAttribute("nwfx-prompt")||null!==(u=prompt(n.getAttribute("nwfx-prompt"))))){t.includes("once")&&n.setAttribute("nwfx-triggered","true"),n.classList.add("nwfx-request");var d={},f=("FORM"!==n.nodeName&&n.hasAttribute("name")&&n.hasAttribute("value")&&(d[n.getAttribute("name")]=n.getAttribute("value")),"FORM"===n.nodeName&&n.querySelectorAll("[name]").forEach(function(e){e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement?d[e.name]=e.value:e.hasAttribute("value")&&(d[e.getAttribute("name")]=e.getAttribute("value"))}),URLEncodeObject(d)),c=("GET"===i&&0<f.length&&(s="".concat(s,"?").concat(f)),document.dispatchEvent(new CustomEvent("nwfx:beforeRequest")),new XMLHttpRequest),l=(c.addEventListener("loadstart",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:loadstart"))}),c.addEventListener("loadend",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:loadend"))}),c.addEventListener("progress",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:progress"))}),c.addEventListener("load",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:load"))}),c.addEventListener("abort",function(){return document.dispatchEvent(new CustomEvent("nwfx:xhr:abort"))}),c.open(i,s,!0),c.onreadystatechange=function(){var e,t;c.readyState===XMLHttpRequest.DONE&&("delete"===a?n.remove():(200<=(e=c.status)&&e<400?("none"!==a&&r&&r instanceof HTMLElement&&(t=(new DOMParser).parseFromString(c.responseText,"text/html"),"innerHTML"===a?(r.innerHTML=c.responseText,hydrateHTMLEvents(r)):"outerHTML"===a?(r.outerHTML=c.responseText,hydrateHTMLEvents(r.parentElement)):"afterbegin"===a?(r.insertAdjacentElement("afterbegin",t.documentElement),hydrateHTMLEvents(t)):"beforebegin"===a?(r.insertAdjacentElement("beforebegin",t.documentElement),hydrateHTMLEvents(t)):"beforeend"===a?(r.insertAdjacentElement("beforeend",t.documentElement),hydrateHTMLEvents(t)):"afterend"===a&&(r.insertAdjacentElement("afterend",t.documentElement),hydrateHTMLEvents(t))),document.dispatchEvent(new CustomEvent("nwfx:afterOnLoad"))):document.dispatchEvent(new CustomEvent("nwfx:responseError",{detail:{status:e,responseText:c.responseText}})),n.classList.remove("nwfx-request")),document.dispatchEvent(new CustomEvent("nwfx:afterRequest")))},c.setRequestHeader("NWFX-Request","true"),c.setRequestHeader("NWFX-Current-URL",window.location.href),{});if(n.hasAttribute("nwfx-headers"))try{l=JSON.parse(n.getAttribute("nwfx-headers"))}catch(e){}n.hasAttribute("id")&&(l["NWFX-Trigger"]=n.id),n.hasAttribute("name")&&(l["NWFX-Trigger-Name"]=n.getAttribute("name")),r&&r instanceof HTMLElement&&r.hasAttribute("id")&&(l["NWFX-Target"]=r.id),n.hasAttribute("nwfx-prompt")&&(l["NWFX-Prompt"]=u),"GET"!==i&&(l["Content-Type"]="application/x-www-form-urlencoded"),Object.keys(l).forEach(function(e){c.setRequestHeader(e,l[e])}),document.dispatchEvent(new CustomEvent("nwfx:beforeSend")),c.send(f)}}}}document.addEventListener("DOMContentLoaded",function(){document.head.insertAdjacentHTML("beforeend","<style>.nwfx-indicator{opacity:0;transition: opacity 200ms ease-in;}.nwfx-request .nwfx-indicator{opacity:1}.nwfx-request.indicator{opacity:1}</style>"),hydrateHTMLEvents(document)}),Array.prototype.includes=function(e){return!!~this.indexOf(e)},NodeList.prototype.forEach=function(e,t){[].forEach.call(this,e,t)};